webpackJsonp([30],{KrOM:function(t,e){},xV9X:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),o=a.n(i),c=a("QX4m"),s=a("9bgf"),r=a("Fd2+"),n=a("g3tQ"),l={name:"home",components:{Service:c.a,Header:s.a},data:function(){return{shopStock:0,JFNum:0,isPower:!0,flag:"",skuStockList:[],memberPriceList:[],memberPriceVal:"",product:{},detailMobileHtml:"",maxNum:1,numVal:"1",productAttributeDetailList:[],productAttributeDetailListNameValue:[],productPackageList:[],current:0,imagelist:[],pabValue:"",padJson:[],shopAmount:0,form:{productId:"",productName:"",price:"",productSkuId:"",productSkuCode:"",productAttr:"",productPic:"",quantity:""},pic:"",show:!1,price:0,wxUrl:"https://mall.hengleikj.com/user/help/index",integrationBuy:null}},mounted:function(){this.getDetailData(),this.shopNumber()},methods:{goBack:function(){window.history.go(-1)},memberIntegration:function(t){var e=this;localStorage.getItem("token")&&n.L().then(function(a){if(200===a.code){e.JFNum=a.data.current;var i=!1;0===t.length&&(i=!0),t.forEach(function(t){t.memberType===a.data.userType&&t.memberLevelName===a.data.memberLevel&&(i=!0)}),i?e.isPower=!1:(e.isPower=!0,e.$notify({message:"您没有权限购买此商品！",color:"#ad0000",background:"#ffe1e1"}))}else e.$notify({message:a.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(t){e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){})},showPic:function(t){Object(r.x)([t])},showDetailAmount:function(){this.show=!0},goLogin:function(){this.$router.push({path:"/user/login"})},toCartMarket:function(){localStorage.getItem("token")?this.$router.push({path:"/market/cart"}):(localStorage.setItem("urlPath","/market/cart"),this.$router.push({path:"/user/login"}))},shopNumber:function(){var t=this;localStorage.getItem("token")?n.p().then(function(e){200===e.code&&(t.shopAmount=0,e.data.map(function(e){t.shopAmount=t.shopAmount+e.quantity}))}).catch(function(t){}).finally(function(){}):t.shopAmount=""},addToCart:function(){var t=this;t.shopStock<t.numVal||0===t.numVal?t.$notify({message:"库存不足，无法加入购物车！",color:"#ad0000",background:"#ffe1e1"}):t.product.integrationBuy?t.$notify({message:"积分商品不可加入购物车！",color:"#ad0000",background:"#ffe1e1"}):localStorage.getItem("token")?(t.form.quantity=t.numVal,t.form.productName=t.product.name,t.form.productPic=t.product.pic,t.form.productId=t.form.productId|t.product.id,t.form.price=t.form.price?t.form.price:t.product.price,t.form.productAttr=o()(t.padJson),n.h(t.form).then(function(e){200===e.code?(t.$toast("该商品，已加入购物车！"),t.$nextTick(function(){t.show=!1,t.shopNumber()})):t.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(e){t.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){})):(localStorage.setItem("urlPath","/market/product"),localStorage.setItem("urlValue",t.$route.query.id),t.$router.push({path:"/user/login"}))},payOrders:function(){var t=this;if(t.integrationBuy&&t.price*t.numVal>t.JFNum)return void t.$notify({message:"积分不足，无法购买",color:"#ad0000",background:"#ffe1e1"});t.shopStock<t.numVal||0===t.numVal?t.$notify({message:"库存不足，无法购买",color:"#ad0000",background:"#ffe1e1"}):0!==t.product.publishStatus?(localStorage.setItem("cartIds",t.product.id),localStorage.getItem("token")?t.$router.push({path:"/user/orders",query:{productId:t.product.id,productSkuCode:t.form.productSkuCode,productSkuId:t.form.productSkuId,quantity:t.numVal,id:t.product.id,integrationBuy:t.integrationBuy}}):(localStorage.setItem("urlPath","/market/product"),localStorage.setItem("urlValue",t.$route.query.id),t.$router.push({path:"/user/login"}))):t.$notify({message:"商品已下架，无法购买",color:"#ad0000",background:"#ffe1e1"})},onChange:function(t){this.current=t},showbigImg:function(t){Object(r.x)({images:this.imagelist,closeable:!0,startPosition:t})},accMul:function(t,e){if(t&&e){var a=0,i=t.toString(),o=e.toString();try{a+=i.split(".")[1].length}catch(t){}try{a+=o.split(".")[1].length}catch(t){}return Number(i.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,a)}},getDetailData:function(){var t=this,e=this;e.pabValue="",e.flag=localStorage.getItem("token"),n.s({id:e.$route.query.id}).then(function(a){if(200===a.code){if(t.memberIntegration(a.data.memberProductList),e.productPackageList=a.data.productPackageList,e.product=a.data.product,e.price=a.data.product.price,e.integrationBuy=a.data.product.integrationBuy,e.detailMobileHtml=a.data.product.detailMobileHtml?a.data.product.detailMobileHtml.replace(/class="wscnph"/g,'style="width: 100%"'):"",e.detailMobileHtml=a.data.product.detailMobileHtml?a.data.product.detailMobileHtml.replace(/style="max-width: 1200px;"/g,'style="width: 100%"'):"",e.product.manualMobileHtml=e.product.manualMobileHtml?e.product.manualMobileHtml.replace(/class="wscnph"/g,'style="width: 100%"'):"",e.product.manualMobileHtml=e.product.manualMobileHtml?e.product.manualMobileHtml.replace(/style="max-width: 1200px;"/g,'style="width: 100%"'):"",e.maxNum=e.product.stock,e.numVal=e.product.minimumNum,e.productAttributeDetailListNameValue=a.data.productAttributeDetailList,e.product.albumPics){var i=e.product.pic+","+e.product.albumPics;e.imagelist=i.split(",")}else e.imagelist=[e.product.pic];a.data.productAttributeDetailList.map(function(t,i){if(0===t.type){var o=[],c={label:t.name,value:[]};t.value.split(",").map(function(c,s){var r="";a.data.skuStockList.map(function(e){e.spData&&JSON.parse(e.spData).map(function(a,i){0===i&&a.key===t.name&&a.value===c&&(r=e.pic)})}),e.pic=e.pic?e.pic:r,o.push({label:c,picc:r,selected:0===s}),0===s&&(e.pabValue=0!==i?e.pabValue+"/"+c:c,e.padJson.push({key:t.name,value:c}))}),c.value=o,e.productAttributeDetailList.push(c)}}),e.skuStockList=a.data.skuStockList,e.shopStock=e.skuStockList[0].stock-e.skuStockList[0].lockStock,e.memberPriceList=a.data.memberPriceList,e.memberPriceVal=void 0!==a.data.memberDiscount?a.data.memberDiscount:"",1===a.data.skuStockList.length?(e.form.productSkuId=a.data.skuStockList[0].id,e.product.price=a.data.skuStockList[0].price,e.price=a.data.skuStockList[0].price,e.form.productId=a.data.skuStockList[0].productId,e.form.productSkuCode=a.data.skuStockList[0].skuCode,e.maxNum=a.data.skuStockList[0].stock):a.data.skuStockList.map(function(t){var a=[];t.spData&&JSON.parse(t.spData).map(function(t){e.padJson&&e.padJson.map(function(e){t.key===e.key&&a.push(e)})}),t.spData===o()(a)&&(e.product.price=t.price,e.form.price=t.price,e.form.productSkuCode=t.skuCode,e.form.productAttr=t.spData,e.form.productSkuId=t.id,e.form.productId=t.productId,e.maxNum=t.lockStock>0?t.stock-t.lockStock:t.stock+t.lockStock,e.numVal=t.stock>0?e.product.minimumNum:0,e.product.stock=t.stock)})}else e.$notify({message:a.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(t){e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){})},selectedClick:function(t,e,a){var i=this;i.skuStockList.forEach(function(t){var a=JSON.parse(t.spData);e===a[0].value&&(i.shopStock=t.stock-t.lockStock)}),i.pabValue="",i.pic=a||i.pic,i.productAttributeDetailList.map(function(a,o){t===a.label&&(i.oneValue=a.label,a.value.map(function(t){t.label===e?(t.selected=!0,i.padJson.map(function(e){e.key===a.label&&(e.value=t.label)})):t.selected=!1})),a.value.map(function(t){t.selected&&(i.pabValue=0!==o?i.pabValue+"/"+t.label:t.label)})}),1===i.skuStockList.length?(i.form.productSkuId=i.skuStockList[0].id,i.form.productId=i.skuStockList[0].productId,i.form.productSkuCode=i.skuStockList[0].skuCode):i.skuStockList.map(function(t){var e=[];t.spData&&JSON.parse(t.spData).map(function(t){i.padJson&&i.padJson.map(function(a){t.key===a.key&&e.push(a)})}),t.spData===o()(e)&&(i.product.price=t.price,i.form.price=t.price,i.form.productSkuCode=t.skuCode,i.form.productAttr=t.spData,i.form.productSkuId=t.id,i.form.productId=t.productId,i.maxNum=t.lockStock>0?t.stock-t.lockStock:t.stock+t.lockStock,i.numVal=t.stock>0?i.product.minimumNum:0,i.product.stock=t.stock)})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Header",{attrs:{name:"详情"}}),t._v(" "),a("div",{directives:[{name:"ban-save",rawName:"v-ban-save"}],staticClass:"productBody"},[a("div",{staticClass:"waresImg"},[a("van-swipe",{on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[a("div",{staticClass:"imgIndex"},[a("span",[t._v(t._s(t.current+1))]),t._v("/"+t._s(t.imagelist.length))])]},proxy:!0}])},t._l(t.imagelist,function(t){return a("van-swipe-item",{key:t.index},[a("img",{attrs:{src:t,alt:""}})])}),1)],1),t._v(" "),a("div",{staticClass:"waresBody"},[1===t.integrationBuy?a("div",{staticClass:"waresMsg",staticStyle:{padding:"0px 0px 31px"}},[a("div",{staticClass:"waresPrice",staticStyle:{width:"120px"}},[a("span",[t._v(t._s(t.price))]),a("b",[t._v(" 积分")])]),t._v(" "),a("div",{staticClass:"waresTitle",staticStyle:{"border-bottom":"none"}},[a("div",{staticClass:"title"},[t._v("\n            "+t._s(t.product.name)+"\n          ")]),t._v(" "),a("div",{staticClass:"ftitle"},[t._v(t._s(t.product.subTitle))])])]):a("div",{staticClass:"waresMsg"},[a("div",{staticClass:"waresPrice",staticStyle:{left:"0","padding-left":"4.22%"}},[a("span",[t._v(t._s(1===t.product.offlineBuy?"线下购买":"￥"+t.price))])]),t._v(" "),a("div",{staticClass:"waresTitle"},[a("div",{staticClass:"title"},[t._v("\n            "+t._s(t.product.name)+"\n          ")]),t._v(" "),a("div",{staticClass:"ftitle"},[t._v(t._s(t.product.subTitle))])]),t._v(" "),a("div",{staticClass:"waresWelfare"},[t.flag?a("div",[""!==t.memberPriceVal?a("div",{staticClass:"rebate"},[t._v("\n              折扣: 该商品享受"),a("span",[t._v(t._s(""!==t.memberPriceVal&&0!==t.memberPriceVal?t.accMul(t.memberPriceVal,10):t.memberPriceVal))]),t._v("折\n            ")]):a("div",[a("span",[t._v("无优惠")])])]):a("div",{staticClass:"rebate"},[t._v("\n            折扣: "),a("span",{on:{click:t.goLogin}},[t._v("登录后查看")])])])]),t._v(" "),a("van-action-sheet",{staticStyle:{background:"#FFFFFF"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticStyle:{"flex-shrink":"0",margin:"0 16px",display:"flex"}},[a("div",{staticStyle:{"flex-shrink":"0",width:"96px",height:"96px",margin:"12px 12px 12px 0",overflow:"hidden","border-radius":"4px"}},[a("img",{staticStyle:{display:"block",width:"100%",height:"100%","object-fit":"cover"},attrs:{src:t.pic||t.product.pic},on:{click:function(e){return t.showPic(t.pic||t.product.pic)}}})]),t._v(" "),a("div",{staticStyle:{display:"flex","-webkit-box-orient":"vertical","-webkit-box-direction":"normal","-webkit-flex-direction":"column","flex-direction":"column","-webkit-box-pack":"end","-webkit-justify-content":"flex-end","justify-content":"flex-end",padding:"12px 20px 12px 0"}},[1===t.integrationBuy?a("div",{staticStyle:{"margin-left":"-2",color:"#ee0a24","font-size":"20px","margin-bottom":"20px"}},[t._v(t._s(t.product.price)),a("span",{staticStyle:{"font-size":"16px"}},[t._v(" 积分")])]):a("div",{staticStyle:{"margin-left":"-2",color:"#ee0a24","font-size":"20px","margin-bottom":"20px"}},[t._v("￥"+t._s(t.product.price))]),t._v(" "),a("div",{staticStyle:{color:"#999999"}},[t._v("已选择商品    "+t._s(t.pabValue))]),t._v(" "),a("div")])]),t._v(" "),a("div",{staticStyle:{"-webkit-box-flex":"1","-webkit-flex":"1 1 auto",flex:"1 1 auto","min-height":"44px","-webkit-overflow-scrolling":"touch","padding-top":"20px"}},[t._l(t.productAttributeDetailList,function(e){return a("div",{key:e.id,staticStyle:{margin:"0 16px 12px"}},[a("div",{staticStyle:{display:"block","font-size":"15px"}},[t._v(t._s(e.label))]),t._v(" "),t._l(e.value,function(i){return a("div",{key:i.id,staticClass:"ggcs-item",class:{"selected-li":i.selected},on:{click:function(a){return t.selectedClick(e.label,i.label,i.picc)}}},[i.picc?a("img",{attrs:{src:i.picc,alt:""}}):t._e(),t._v(" "),a("p",[t._v(t._s(i.label))])])})],2)}),t._v(" "),a("div",{staticStyle:{padding:"12px 16px",overflow:"hidden","line-height":"30px"}},[a("div",{staticStyle:{float:"left"}},[t._v("数量")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("van-stepper",{attrs:{min:t.product.minimumNum,disabled:0===t.product.stock,"button-size":"30px","input-width":"36px"},model:{value:t.numVal,callback:function(e){t.numVal=e},expression:"numVal"}})],1)])],2),t._v(" "),a("div",{staticClass:"v-buttom-ct"},[a("button",{staticStyle:{background:"linear-gradient(to right, #ffd01e, #ff8917)","border-top-left-radius":"20px","border-bottom-left-radius":"20px"},on:{click:function(e){return t.addToCart()}}},[t._v("加入购物车")]),t._v(" "),a("button",{staticStyle:{background:"linear-gradient(to right, #ff6034, #ee0a24)","border-top-right-radius":"20px","border-bottom-right-radius":"20px"},on:{click:t.payOrders}},[t._v("立即购买")])])]),t._v(" "),a("div",{staticClass:"waresParameter"},[a("h1",[t._v("规格参数")]),t._v(" "),a("div",{staticClass:"parameter"},t._l(t.productAttributeDetailListNameValue,function(e){return a("div",{key:e.id,staticClass:"paraList"},[a("div",{staticClass:"paraName"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"paraDetails"},[t._v(t._s(e.value||"-"))])])}),0)]),t._v(" "),a("div",{staticClass:"packing",staticStyle:{"margin-top":"10px"}},[a("h1",[t._v("包装")]),t._v(" "),a("div",{staticClass:"parameter"},t._l(t.productPackageList,function(e){return a("div",{key:e.id,staticClass:"gift"},[t._v(t._s(e.itemName)+" X "+t._s(e.itemNum))])}),0)]),t._v(" "),a("div",{staticClass:"packing",staticStyle:{"margin-top":"10px"}},[a("h1",[t._v("售后")]),t._v(" "),a("div",{staticClass:"explain"},[t._v("\n          "+t._s(t.product.note)+"\n        ")])]),t._v(" "),a("div",{staticClass:"packing",staticStyle:{"margin-top":"10px"}},[a("h1",[t._v("说明书")]),t._v(" "),a("div",{staticClass:"explain",domProps:{innerHTML:t._s(t.product.manualMobileHtml)}})])],1),t._v(" "),a("div",{staticClass:"shopimgFont"},[t._m(0),t._v(" "),t.detailMobileHtml?a("div",{staticClass:"wareImg",domProps:{innerHTML:t._s(t.detailMobileHtml)}},[t._v("\n        "+t._s(t.detailMobileHtml)+"\n      ")]):t._e()]),t._v(" "),a("div",{staticStyle:{width:"100%",height:"60px"}}),t._v(" "),0!==t.product.offlineBuy||1===t.product.offlineBuy||t.product.integrationBuy?0===t.product.offlineBuy&&1!==t.product.offlineBuy&&1===t.product.integrationBuy?a("van-goods-action",[a("van-goods-action-button",{style:{borderRadius:"0px",height:"50px",width:"35%",margin:"0px"},attrs:{type:"danger",text:"立即购买",color:"#FD2744",disabled:t.isPower},on:{click:t.showDetailAmount}})],1):a("van-goods-action",[a("van-goods-action-icon",{style:{height:"45px",width:"30%"},attrs:{icon:"shopping-cart-o",text:"购物车",badge:t.shopAmount},on:{click:t.toCartMarket}}),t._v(" "),a("van-goods-action-button",{style:{borderRadius:"0px",height:"50px",width:"35%"},attrs:{type:"warning",text:"加入购物车",color:"linear-gradient(262deg, #FA5B08 0%, #F87A00 100%)",disabled:""},on:{click:t.showDetailAmount}}),t._v(" "),a("van-goods-action-button",{style:{borderRadius:"0px",height:"50px",width:"35%",margin:"0px"},attrs:{type:"danger",text:"立即购买",color:"#FD2744",disabled:""},on:{click:t.showDetailAmount}})],1):a("van-goods-action",[a("van-goods-action-icon",{style:{height:"45px",width:"30%"},attrs:{icon:"shopping-cart-o",text:"购物车",badge:t.shopAmount},on:{click:t.toCartMarket}}),t._v(" "),a("van-goods-action-button",{style:{borderRadius:"0px",height:"50px",width:"35%"},attrs:{type:"warning",text:"加入购物车",color:"linear-gradient(262deg, #FA5B08 0%, #F87A00 100%)",disabled:t.isPower},on:{click:t.showDetailAmount}}),t._v(" "),a("van-goods-action-button",{style:{borderRadius:"0px",height:"50px",width:"35%",margin:"0px"},attrs:{type:"danger",text:"立即购买",color:"#FD2744",disabled:t.isPower},on:{click:t.showDetailAmount}})],1),t._v(" "),a("Service")],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"waredetails"},[e("div",{staticClass:"text01"}),this._v(" "),e("div",{staticClass:"text02"},[this._v("商品图文详情")]),this._v(" "),e("div",{staticClass:"text03"})])}]};var d=a("VU/8")(l,u,!1,function(t){a("KrOM")},"data-v-1913350a",null);e.default=d.exports}});
//# sourceMappingURL=30.cb5d8b2a41a8a2ebe97a.js.map