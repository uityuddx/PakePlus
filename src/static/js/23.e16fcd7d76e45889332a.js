webpackJsonp([23],{ABts:function(e,t){},AI6o:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("QX4m"),n=i("9bgf"),s=i("g3tQ"),r={name:"home",components:{Service:a.a,Header:n.a},data:function(){return{value:"",list:[],loading:!1,finished:!1,newArr:[],form:{pageNum:1,pageSize:8,keyword:""},treeList:[],activeName:"",id:"",valIndex:"",className:""}},mounted:function(){this.activeName=this.$route.query.oid,this.valIndex=this.$route.query.sid,this.id=this.$route.query.id,this.getTreeList(),this.value=this.$route.query.search,this.$route.query.oid&&!this.$route.query.id?this.onClickName(this.$route.query.oid,"全部"):this.onSearch(this.value,this.$route.query.id)},methods:{selectDetail:function(e){this.valIndex=e.id,this.onSearch(this.form.keyword,e.id,!1)},getTreeList:function(){var e=this;s.q().then(function(t){if(200===t.code){e.treeList.push({key:e.activeName,id:e.activeName,name:"全部"});var i=[];t.data.map(function(t){Number(e.activeName)===t.id&&(e.className=t.name,t.children.map(function(t,i){t.id===Number(e.id)&&(e.activeName=t.id)}),i=t.children)}),e.treeList=e.treeList.concat(i)}else e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(t){e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})})},onClickName:function(e,t){var i=this;i.valIndex="","全部"===t?(i.form.level=0,this.onSearch(i.form.keyword,i.$route.query.oid,!0)):(i.form.level="",this.onSearch(i.form.keyword,e,!1))},onSearch:function(e,t,i){var a=this;a.list=[],a.newArr=[],a.loading=!1,a.finished=!1,a.form.pageNum=1,a.form.keyword=(void 0!==e?e:a.$route.query.search)||e||a.value,a.valIndex?a.form.productCategoryId=a.valIndex:a.form.productCategoryId=i?t:t||a.form.productCategoryId,s.z(a.form).then(function(e){200===e.code?a.list=e.data.list:a.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(e){a.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})})},onLoading:function(){var e=this;s.z(e.form).then(function(t){200===t.code?t.data.list?(e.form.pageNum++,e.newArr=e.newArr.concat(t.data.list),e.list=e.newArr,e.list.length>=t.data.total?(e.loading=!0,e.finished=!0):e.loading=!1):e.list=[]:e.$message.error(t.message)}).catch(function(t){e.$message.error(t.message)}).finally(function(){})},discountDetails:function(e,t){if(e&&t){var i=0,a=e.toString(),n=t.toString();try{i+=a.split(".")[1].length}catch(e){}try{i+=n.split(".")[1].length}catch(e){}return Number(a.replace(".",""))*Number(n.replace(".",""))/Math.pow(10,i)}},getProductDetail:function(e){this.$router.push({path:"/market/product",query:{id:e.id}})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Header",{attrs:{name:e.className?e.className:"搜索列表"}}),e._v(" "),a("div",{directives:[{name:"ban-save",rawName:"v-ban-save"}],staticStyle:{background:"#f6f6f6","min-height":"700px",position:"relative"}},[a("form",{attrs:{action:"javascript:return true"}},[a("van-search",{staticStyle:{"margin-bottom":"10px","padding-top":"0px"},attrs:{"show-action":"",shape:"round",placeholder:"搜索商品"},on:{search:e.onSearch},scopedSlots:e._u([{key:"action",fn:function(){return[a("div",{staticClass:"vsearch",on:{click:function(t){return e.onSearch("")}}},[e._v("搜索")])]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("img",{staticStyle:{position:"absolute",top:"9px",width:"15px",height:"15px",left:"22px"},attrs:{src:i("hDxa"),alt:"",width:"46px",height:"46px"}}),e._v(" "),e.treeList.length>1?a("van-tabs",{on:{click:e.onClickName},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.treeList,function(t){return a("van-tab",{key:t.id,attrs:{name:t.id,title:t.name}},[t.children&&t.children.length>0?a("ul",{staticClass:"uli-class"},e._l(t.children,function(t){return a("li",{key:t.id,class:e.valIndex+""==t.id+""?"selectd":"",on:{click:function(i){return e.selectDetail(t)}}},[e._v(e._s(t.name)+"\n          ")])}),0):e._e(),e._v(" "),a("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:function(t){return e.onLoading()}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[a("van-grid",{staticStyle:{"padding-bottom":"100px"},attrs:{border:!1,"column-num":2,gutter:10}},e._l(e.list,function(t){return a("van-grid-item",{key:t.id,staticStyle:{width:"50%"},on:{click:function(i){return e.getProductDetail(t)}}},[t.memberDiscount?a("div",{staticClass:"allowance"},[e._v("享"+e._s(e.discountDetails(t.memberDiscount,10))+"折")]):e._e(),e._v(" "),a("van-image",{attrs:{src:t.pic}}),e._v(" "),a("div",{staticClass:"shopMessage"},[a("div",{staticClass:"shopTitle"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"shopOther"},[a("div",{staticClass:"tariff"},[1===t.offlineBuy?a("span",{staticStyle:{"font-size":"15px"}},[e._v("线下购买")]):a("span",[e._v("￥"+e._s(t.price))])])])])],1)}),1)],1)],1)}),1):e._e(),e._v(" "),1===e.treeList.length?a("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:function(t){return e.onLoading()}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[a("van-grid",{staticStyle:{"padding-bottom":"100px"},attrs:{border:!1,"column-num":2,gutter:10}},e._l(e.list,function(t){return a("van-grid-item",{key:t.id,staticStyle:{width:"50%"},on:{click:function(i){return e.getProductDetail(t)}}},[t.memberDiscount?a("div",{staticClass:"allowance"},[e._v("享"+e._s(e.discountDetails(t.memberDiscount,10))+"折")]):e._e(),e._v(" "),a("van-image",{attrs:{src:t.pic}}),e._v(" "),a("div",{staticClass:"shopMessage"},[a("div",{staticClass:"shopTitle"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"shopOther"},[a("div",{staticClass:"tariff"},[1===t.offlineBuy?a("span",{staticStyle:{"font-size":"15px"}},[e._v("线下购买")]):a("span",[e._v("￥"+e._s(t.price))])])])])],1)}),1)],1):e._e(),e._v(" "),a("Service")],1)],1)},staticRenderFns:[]};var c=i("VU/8")(r,o,!1,function(e){i("ABts")},"data-v-51db44ac",null);t.default=c.exports}});
//# sourceMappingURL=23.e16fcd7d76e45889332a.js.map