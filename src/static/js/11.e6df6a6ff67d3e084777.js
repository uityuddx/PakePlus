webpackJsonp([11],{Plz8:function(t,e){},UbBS:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAoCAYAAACIC2hQAAAAAXNSR0IArs4c6QAAAz1JREFUWEfV12uITGEYB/D//8zuMiXrVu4RHxQJuYWUchnNOTNJrSjlCyXhA1I+0ColKUI+uJUiPixpzXOM3ZJyz5a2FKVEck0uuezaZc6jM2N2Z2Znd2azO17zceZ53ufX/z295x2qba8BeRrAA4pMh6Efqm3PB3kDwGeKDDTUCeqSJaNRUfEiCVQdRNf9ZCKWWlUVQHNzKwALQB3IL/8UqtoM1Ucgz1LkVdrCZJCO8xGAadveBHI9Y7EzvjENbQQw5Z8mmX94AqqL6brXU1DbPgNytYFQn3SHIvNS0EhkF1R3Gwr18O1bZXrr1wE4bigUSCRGp6Dh8GxY1j1jocHggBQ0Gh0Bz2s7CgwDK0TKUtDqagsNDT9AlhuG9DlfKdI/Cf1zlj4HMMZA6CuKjGqH2vYtkPMMhD6myMTMRM8DWGkg9B5F5mQmuh/kNgOh9RQJZSa6GcAhA6EXKFKVmehykBeNg5KnGIutbYdGIjOhet84qOpBuu6WdmgoNBzl5a+NgwK7KVLdDvUvzo7TDKCiIJZtbQVL8xaodqdvK0UOZE1U234Gcmynq8yaBezYAZSVdWdQx9pfv4C9e4H7RT1p6yhyMhvqOP6fvPmdKkIhYOPGv0Omu48eBa5eLbyW6gq6bk1uoudAruqye/x4oE+fwgO6qmhpAZ4+LW4N1aV03brcRPcB2F7cCiWrmkuRu7mJbgJ5uGSEYgYFApNYW/soGxqJLIPqpWL6S1bj3+7j8ZfZ0HB4BiyroWSIYgYlEpWMx79kQ6PRofC8t8X0l6gmAZFyAtrh5FbHeQ9gSIkghcY8ocgEvygf9AiAHjosCzkK/p58feaHLlw4GMGg/8oYV3CZ3i14iNbWOayv/54X6n+pjjMS5DGohvOl3qs+VYVl1aCpaQOvXfuQntXl7ULD4TEIBCbD84K9imvT8Dssq5GXL3e4xf3lNagk/OSQrhO17UWwrENQHQGgBonEJsbjLT3J02h0AjzvBICpAG7i58+1rKt7kzujU6ja9kCQzwBUZjTtpMieHoU6zgMA09rWJGsZiy3rDnQuyNs5DVcoYvcUVBcs6It+/ZpydvYdRYZ1B/p/JJo8pgx6Rn8DxOszKYZBqLkAAAAASUVORK5CYII="},xi0G:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=a("mvHQ"),i=a.n(c),n=a("QX4m"),s=a("9bgf"),u=a("g3tQ"),o={name:"home",components:{Service:n.a,Header:s.a},data:function(){return{userType:0,buyPower:"",buyArr:[],checkedAll:!1,edit:!0,editFont:"编辑",cartList:[],numTotal:0,numReduce:0,checkqx:0,wxUrl:"https://mall.hengleikj.com/user/help/index"}},mounted:function(){this.getCartList()},methods:{getCartList:function(){var t=this;localStorage.getItem("token")?u.p().then(function(e){if(200===e.code){var a=e.data;u.L().then(function(e){t.buyPower=e.data.memberLevel,t.userType=e.data.userType,t.numTotal=0,t.numReduce=0,a.map(function(e,a){return e.flag=!1,e.maxQuantity=e.realStock,e.buyArr=!1,0===e.memberProductList.length?e.buyArr=!0:e.memberProductList.forEach(function(a){a.memberType===t.userType&&t.buyPower===a.memberLevelName&&(e.buyArr=!0)}),e}),t.cartList=a})}else t.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(e){t.$notify({message:e.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){}):(t.numTotal=0,t.cartList=[])},goShop:function(t){this.$router.push({path:"/market/product",query:{id:t.productId}})},toPages:function(t){if("0"===t)this.$router.push({path:"/market/home"});else if("1"===t)this.$router.push({path:"/market/classify"});else if("2"===t)if(localStorage.getItem("token"))this.$router.push({path:"/market/cart"});else{var e=navigator.userAgent;if(this.isWeixin=!!/MicroMessenger/i.test(e),this.isWeixin){window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx372e6d05b22ce032&redirect_uri="+this.wxUrl+"&response_type=code&scope=snsapi_base&state="+i()({name:"home",url:"/market/cart"})+"#wechat_redirect"}else localStorage.setItem("urlPath","/market/cart"),this.$router.push({path:"/user/login"})}else if("3"===t)if(localStorage.getItem("token"))this.$router.push({path:"/user/home"});else{var a=navigator.userAgent;if(this.isWeixin=!!/MicroMessenger/i.test(a),this.isWeixin){window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx372e6d05b22ce032&redirect_uri="+this.wxUrl+"&response_type=code&scope=snsapi_base&state="+i()({name:"home",url:"/user/home"})+"#wechat_redirect"}else localStorage.setItem("urlPath","/user/home"),this.$router.push({path:"/user/login"})}},changeState:function(){this.edit=!this.edit,this.edit?this.editFont="编辑":this.editFont="取消"},nowSettle:function(){var t=this;t.$nextTick(function(){var e=[];if(t.buyArr=[],t.cartList.map(function(a,c){a.flag&&(e.push(a.id),a.buyArr||t.buyArr.push({id:a.id,name:a.productName}))}),e.length>0){if(0===t.buyArr.length){var a=!1,c="";t.cartList.forEach(function(t){e.includes(t.id)&&0===t.publishStatus&&(a=!0,c=t.productName)}),a?t.$notify({message:c+"该商品已下架，无法购买",color:"#ad0000",background:"#ffe1e1"}):(localStorage.setItem("cartIds",e),t.$router.push({path:"/user/orders"}))}t.buyArr.forEach(function(a){e.includes(a.id)&&t.$notify({message:"您没有权限购买"+a.name,color:"#ad0000",background:"#ffe1e1"})})}else t.$notify({message:"请选择需要购买的商品",color:"#ad0000",background:"#ffe1e1"})},500)},deleteAll:function(){var t=this;t.cartList.map(function(e,a){t.checkedAll?t.deleteDetail(e):e.flag&&t.deleteDetail(e)})},deleteDetail:function(t){var e=this;e.checkedAll=!1,e.selectClickData(t),u.g({ids:t.id}).then(function(t){200===t.code?e.$nextTick(function(){e.getCartList()},500):(e.$nextTick(function(){e.getCartList()},500),e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"}))}).catch(function(t){e.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){})},selectClickAll:function(){var t=this;t.numTotal=0,t.numReduce=0,t.checkedAll?t.cartList.map(function(e,a){return e.quantity>e.realStock||1===e.offlineBuy?e.flag=!1:(t.numTotal=t.accAdd(t.numTotal,t.accMul(e.price,e.quantity)),t.numReduce=0!==e.reduceAmount?t.accAdd(t.numReduce,t.accMul(e.reduceAmount,e.quantity)):t.numReduce,t.checkqx=t.cartList.length,e.flag=!0),e}):(t.numTotal=0,t.numReduce=0,t.checkqx=0,t.cartList.map(function(t,e){return t.flag=!1,t})),this.resetNumTotal()},selectClickData:function(t){var e=this;e.numReduce=0,t.quantity>t.realStock||(t.flag?(e.checkqx+=1,e.checkqx===e.cartList.length&&(e.checkedAll=!0),e.numTotal=e.accAdd(e.numTotal,e.accMul(t.price,t.quantity)),e.numReduce=0!==t.reduceAmount?e.accAdd(e.numReduce,e.accMul(t.reduceAmount,t.quantity)):e.numReduce):(e.checkedAll=!1,e.checkqx-=1,e.checkqx<0&&(e.checkqx=0),e.numTotal=e.accSub(e.numTotal,e.accMul(t.price,t.quantity)),e.numReduce=0!==t.reduceAmount?e.accAdd(e.numReduce,e.accMul(t.reduceAmount,t.quantity)):e.numReduce),this.resetNumTotal())},updQuantity:function(t){var e=this,a=this;u.i({id:t.id,quantity:t.quantity}).then(function(t){200===t.code||a.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).catch(function(t){a.$notify({message:t.message,color:"#ad0000",background:"#ffe1e1"})}).finally(function(){e.resetNumTotal()})},resetNumTotal:function(){var t=this;t.numTotal=0,t.numReduce=0,t.checkedAll?t.cartList.map(function(e,a){t.numTotal=t.accAdd(t.numTotal,e.memberDiscount?t.accMul(t.accMul(e.price,e.quantity),e.memberDiscount):t.accMul(e.price,e.quantity)),t.numReduce=0!==e.reduceAmount?t.accAdd(t.numReduce,t.accMul(e.reduceAmount,e.quantity)):t.numReduce}):t.cartList.map(function(e,a){e.flag&&(t.numTotal=t.accAdd(t.numTotal,e.memberDiscount?t.accMul(t.accMul(e.price,e.quantity),e.memberDiscount):t.accMul(e.price,e.quantity)),t.numReduce=0!==e.reduceAmount?t.accAdd(t.numReduce,t.accMul(e.reduceAmount,e.quantity)):t.numReduce)})},accMul:function(t,e){if(t&&e){var a=0,c=t.toString(),i=e.toString();try{a+=c.split(".")[1].length}catch(t){}try{a+=i.split(".")[1].length}catch(t){}return Number(c.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,a)}},accAdd:function(t,e){if((t||0===t)&&(e||0===t)){var a,c=void 0,i=void 0;try{c=t.toString().split(".")[1].length}catch(t){c=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return(t*(a=Math.pow(10,Math.max(c,i)))+e*a)/a}},accSub:function(t,e){if((t||0===t)&&(e||0===t)){var a,c=void 0,i=void 0;try{c=t.toString().split(".")[1].length}catch(t){c=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return a=Math.pow(10,Math.max(c,i)),c>=i?c:i,((t*a-e*a)/a).toFixed(2)}}}},r={render:function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{directives:[{name:"ban-save",rawName:"v-ban-save"}],staticClass:"mask-body"},[c("Header",{attrs:{name:"购物车"}}),t._v(" "),c("div",{staticClass:"head"},[c("p",{staticClass:"text2",on:{click:t.changeState}},[t._v(t._s(t.editFont))])]),t._v(" "),c("div",{staticClass:"body"},[t.cartList&&t.cartList.length>0?c("div",t._l(t.cartList,function(e){return c("div",{key:e.id,staticClass:"shopCartt"},[c("div",{staticClass:"top"},[c("van-checkbox",{attrs:{"checked-color":"#ee0a24",disabled:e.quantity>e.realStock||1===e.offlineBuy},on:{click:function(a){return t.selectClickData(e)}},model:{value:e.flag,callback:function(a){t.$set(e,"flag",a)},expression:"item.flag"}}),t._v(" "),c("div",{staticClass:"shopImg",on:{click:function(a){return t.goShop(e)}}},[c("van-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.productPic?e.productPic:""}}),t._v(" "),e.memberDiscount?c("div",{staticClass:"discount"},[t._v("享"+t._s(t.accMul(e.memberDiscount,10))+"折")]):t._e()],1),t._v(" "),c("div",{staticClass:"shopMsg"},[c("div",{staticClass:"shopName"},[t._v("\n              "+t._s(e.productName)+"\n            ")]),t._v(" "),e.productAttr?c("div",{staticClass:"shopSpecs"},t._l(JSON.parse(e.productAttr||"[]"),function(e,a){return c("div",{key:a},[t._v(t._s(e.value))])}),0):c("div",{staticStyle:{"min-height":"20px"}}),t._v(" "),c("div",{staticClass:"shopIntegral"},[t._v("赠送"+t._s(e.memberDiscount?Math.floor(Number(t.accMul(t.accMul(e.price,e.memberDiscount),e.quantity))):Math.floor(Number(t.accMul(e.price,e.quantity))))+"积分")])])],1),t._v(" "),c("div",{staticClass:"bottom"},[c("div"),t._v(" "),c("div",{staticClass:"bomRight"},[c("div",{staticClass:"amount"},[t._v("￥"+t._s(t.accMul(e.price,e.quantity)))]),t._v(" "),c("div",{staticClass:"num"},[c("van-stepper",{attrs:{"async-change":"","button-size":"20px","input-width":"36px",integer:"",max:e.maxQuantity,min:e.minimumNum},on:{change:function(a){return t.updQuantity(e)}},model:{value:e.quantity,callback:function(a){t.$set(e,"quantity",a)},expression:"item.quantity"}})],1)])])])}),0):c("div",{staticClass:"showNo"},[t._v("\n      暂无数据\n    ")])]),t._v(" "),c("div",{staticClass:"footer"},[c("div",{staticClass:"allchoice"},[c("van-checkbox",{attrs:{"checked-color":"#ee0a24"},on:{click:t.selectClickAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v("全选")])],1),t._v(" "),t.edit?c("div",[c("div",{staticClass:"price"},[c("div",{staticClass:"total"},[t._v("总计："),c("span",{staticClass:"allMon"},[t._v("￥"+t._s(t.numTotal.toFixed(2)))])]),t._v(" "),c("div",{staticClass:"preferential"},[t._v("优惠："),c("span",[t._v("￥"+t._s(t.numReduce))])])]),t._v(" "),c("div",{staticClass:"closeBtn",on:{click:t.nowSettle}},[t._v("立即结算")])]):c("div",[c("div",{staticClass:"deleteBtn",on:{click:t.deleteAll}},[t._v("删除")])])]),t._v(" "),c("div",{staticStyle:{width:"100%",height:"94px"}}),t._v(" "),c("div",{staticClass:"footers"},[c("div",{staticClass:"firstPage",on:{click:function(e){return t.toPages("0")}}},[c("img",{attrs:{src:a("H3EJ"),alt:""}}),t._v(" "),c("p",[t._v("首页")])]),t._v(" "),c("div",{staticClass:"sort",on:{click:function(e){return t.toPages("1")}}},[c("img",{attrs:{src:a("aa+x"),alt:""}}),t._v(" "),c("p",[t._v("分类")])]),t._v(" "),c("div",{staticClass:"shopCart",on:{click:function(e){return t.toPages("2")}}},[c("img",{attrs:{src:a("UbBS"),alt:""}}),t._v(" "),c("p",{staticClass:"ptitle"},[t._v("购物车")])]),t._v(" "),c("div",{staticClass:"myMessage",on:{click:function(e){return t.toPages("3")}}},[c("img",{attrs:{src:a("dYI7"),alt:""}}),t._v(" "),c("p",[t._v("我的")])])]),t._v(" "),c("Service")],1)},staticRenderFns:[]};var l=a("VU/8")(o,r,!1,function(t){a("Plz8")},"data-v-6e4dbef6",null);e.default=l.exports}});
//# sourceMappingURL=11.e6df6a6ff67d3e084777.js.map